$.maintain={icon:{initIconList:function(a,b){if(!b){b=function(c){a.next("i").remove();
a.val(c);a.after("<i class='"+c+"' style='margin-left:10px;'></i>")
}}a.off("click").on("click",function(){var c=$(".sys-icon-list");
if(c.is(":visible")){e();
return}if(!c.length){$.ajax({type:"GET",async:false,url:ctx+"/maintain/icon/select",success:function(f){$("body").append(f)
}});c=$(".sys-icon-list")
}var d=a.offset();
c.css({left:d.left+"px",top:d.top+a.outerHeight()+"px"}).slideDown("fast");
c.find(".tab-pane").niceScroll({domfocus:true,hidecursordelay:2000});
c.find(".tab-pane").getNiceScroll().show();
$("body").bind("mousedown",e);
function e(g){if(g){var h=$(g.target);
var f=h.closest("a.sys-icon-btn");
if(f.length){b(f.find("i").attr("class"))
}if(!f.length&&h.closest(".sys-icon-list").length){return
}}c.find(".tab-pane").getNiceScroll().hide();
c.fadeOut("fast");
$("body").unbind("mousedown",e)
}})}},staticResource:{initBtn:function(){$(".btn-version").click(function(){$.app.waiting("正在执行...");
var d=$(this).closest("tr");
var e=d.find("[name='fileName']").val();
var c=d.find("[name='content']").val();
var a=d.find("[name='version']").text();
if(!a){a="1"
}else{a=parseInt(a)+1
}var b=ctx+"/maintain/staticResource/incVersion";
$.post(b,{fileName:e,content:c,newVersion:a},function(f){$.app.waitingOver();
d.find("[name='version']").text(a);
d.find("[name='content']").val(f);
$.app.alert({message:"操作成功"})
});return false
});$(".btn-batch-version").click(function(){var a=$.table.getAllSelectedCheckbox($("#table"));
if(!a.length){return
}$.app.confirm({message:"确认选中的js/css版本+1吗？",ok:function(){var f=[];
var d=[];var c=[];
for(var h=0,e=a.length;
h<e;h++){var m=$(a[h]).closest("tr");
var g=m.find("[name='fileName']").val();
var k=m.find("[name='content']").val();
var j=m.find("[name='version']").text();
if(!j){j="1"
}else{j=parseInt(j)+1
}f[f.length]=g;
d[d.length]=k;
c[c.length]=j
}var b=ctx+"/maintain/staticResource/batchIncVersion";
$.post(b,{"fileNames[]":f,"contents[]":d,"newVersions[]":c},function(i){$.app.alert({message:i,ok:function(){window.location.reload()
}})})}})});
$(".btn-clear-version").click(function(){var a=$.table.getAllSelectedCheckbox($("#table"));
if(!a.length){return
}$.app.confirm({message:"确认清空选中的js/css版本吗？",ok:function(){var c=[];
var g=[];for(var e=0,b=a.length;
e<b;e++){var h=$(a[e]).closest("tr");
var j=h.find("[name='fileName']").val();
var f=h.find("[name='content']").val();
c[c.length]=j;
g[g.length]=f
}var d=ctx+"/maintain/staticResource/clearVersion";
$.post(d,{"fileNames[]":c,"contents[]":g},function(i){$.app.alert({message:i,ok:function(){window.location.reload()
}})})}})});
$(".btn-compress").click(function(){$.app.waiting("正在执行...");
var c=$(this).closest("tr");
var d=c.find("[name='fileName']").val();
var b=c.find("[name='content']").val();
var a=ctx+"/maintain/staticResource/compress";
$.post(a,{fileName:d,content:b},function(e){$.app.waitingOver();
$.app.alert({message:e})
});return false
});$(".btn-batch-compress").click(function(){var a=$.table.getAllSelectedCheckbox($("#table"));
if(!a.length){return
}$.app.confirm({message:"确认压缩选中的js/css吗？",ok:function(){var c=[];
var g=[];for(var e=0,b=a.length;
e<b;e++){var h=$(a[e]).closest("tr");
var j=h.find("[name='fileName']").val();
var f=h.find("[name='content']").val();
c[c.length]=j;
g[g.length]=f
}var d=ctx+"/maintain/staticResource/batchCompress";
$.post(d,{"fileNames[]":c,"contents[]":g},function(i){$.app.alert({message:i,ok:function(){window.location.reload()
}})})}})});
$(".btn-switch").click(function(){$.app.waiting("正在执行...");
var b=$(this);
var d=b.closest("tr");
var e=d.find("[name='fileName']").val();
var c=d.find("[name='content']").val();
var a=ctx+"/maintain/staticResource/switch";
$.post(a,{fileName:e,content:c,min:b.hasClass("min")},function(f){$.app.waitingOver();
if(f.success){d.find("[name='content']").val(f.content);
d.find("[name='url']").text(f.url)
}$.app.alert({message:f.msg})
});return false
});$(".btn-batch-switch").click(function(){var a=$(this);
var b=$.table.getAllSelectedCheckbox($("#table"));
if(!b.length){return
}$.app.confirm({message:"确认切换选中的js/css吗？",ok:function(){var d=[];
var h=[];for(var f=0,c=b.length;
f<c;f++){var j=$(b[f]).closest("tr");
var k=j.find("[name='fileName']").val();
var g=j.find("[name='content']").val();
d[d.length]=k;
h[h.length]=g
}var e=ctx+"/maintain/staticResource/batchSwitch";
$.post(e,{"fileNames[]":d,"contents[]":h,min:a.hasClass("min")},function(i){$.app.alert({message:i,ok:function(){window.location.reload()
}})})}})})}},editor:{initBtn:function(){$(".btn-rename").click(function(){var b=$.table.getFirstSelectedCheckbox($("#table"));
if(!b.length){return
}var c=b.val();
var a=b.siblings("[name='names']").val();
$.app.confirm({title:"重命名",message:"请输入新的名字：<input type='text' id='newName' value='"+a+"'/>",ok:function(){var d=$("#newName").val();
if(!$.trim(d)){$.app.alert({message:"新名称不能为空"});
return}location.href=ctx+"/maintain/editor/rename?path="+c+"&newName="+d
}})});$(".btn-delete").click(function(){var a=$.table.getAllSelectedCheckbox($("#table"));
if(!a.length){return
}$.app.confirm({title:"确认删除选中的文件",message:"<strong class='text-error'>注意：</strong><span class='text-error muted'>如果选择的是目录将会删除子目录！并且此操作不可恢复，执行请慎重！</span><br/><br/><span class='text-error'>请输入 <strong>ok</strong> 进行删除：</span><input type='text' id='confirmText' class='input-small'>",ok:function(){var b=$("#confirmText").val();
if(b!="ok"){$.app.alert({message:"请输入<strong>ok</strong>确认执行操作！"});
return}location.href=ctx+"/maintain/editor/delete?"+a.serialize()
}})});$(".btn-create-directory").click(function(){var a=$(this).closest(".tool").data("current-path");
$.app.confirm({title:"新建目录",message:"请输入目录名字：<input type='text' id='name' placeholder='支持如/a/b/c多级目录'/>",ok:function(){var b=$("#name").val();
if(!$.trim(b)){$.app.alert({message:"名称不能为空"});
return}location.href=ctx+"/maintain/editor/create/directory?parentPath="+a+"&name="+b
}})});$(".btn-create-file").click(function(){var a=$(this).closest(".tool").data("current-path");
$.app.confirm({title:"新建文件",message:"请输入文件名字：<input type='text' id='name' placeholder='支持如/a/b.txt多级目录'/>",ok:function(){var b=$("#name").val();
if(!$.trim(b)){$.app.alert({message:"名称不能为空"});
return}location.href=ctx+"/maintain/editor/create/file?parentPath="+a+"&name="+b
}})});$(".btn-upload").click(function(){var a=$(this).closest(".tool").data("current-path");
location.href=ctx+"/maintain/editor/upload?parentPath="+a
});$(".btn-compress").click(function(){var b=$.table.getAllSelectedCheckbox($("#table"));
if(!b.length){return
}var a=$(this).closest(".tool").data("current-path");
$.app.confirm({title:"确认压缩并下载选中的文件",message:"<strong class='text-error'>注意：</strong><span class='text-error muted'>如果选择的文件比较大，速度可能比较慢！</span><br/><br/><span class='text-error'>请输入 <strong>ok</strong> 进行压缩并下载：</span><input type='text' id='confirmText' class='input-small'>",ok:function(){var c=$("#confirmText").val();
if(c!="ok"){$.app.alert({message:"请输入<strong>ok</strong>确认执行操作！"});
return}window.location.href=ctx+"/maintain/editor/compress?parentPath="+a+"&"+b.serialize()
}})});$(".btn-uncompress").click(function(){var b=$.table.getAllSelectedCheckbox($("#table"));
if(!b.length){return
}var a=true;
$(b).each(function(){if(decodeURIComponent($(this).val()).toLowerCase().indexOf(".zip")==-1){a=false
}});if(!a){$.app.alert({message:"目前只支持zip文件的解压缩，请只选择zip文件"});
return}$.app.confirm({title:"确认解压选中的文件",message:"<span class='text-error muted'>冲突时：<label class='radio inline'><input type='radio' name='conflict' value='override'>覆盖</label><label class='radio inline'><input type='radio' name='conflict' value='ignore' checked='checked'>跳过</label><br/><br/><span class='text-error'>请输入 <strong>ok</strong> 进行解压：</span><input type='text' id='confirmText' class='input-small'>",ok:function(){var c=$("[name=conflict]:checked").val();
var d=$("#confirmText").val();
if(d!="ok"){$.app.alert({message:"请输入<strong>ok</strong>确认执行操作！"});
return}$.app.modalDialog("选择解压到的目录",ctx+"/maintain/editor/select?"+b.serialize(),{height:300,width:300,ok:function(f){var e=$.fn.zTree.getZTreeObj(f.find("#selectTree .ztree").attr("id"));
var g=e.getSelectedNodes()[0];
var h=g.path;
window.location.href=ctx+"/maintain/editor/uncompress?descPath="+h+"&conflict="+c+"&"+b.serialize()
}})}})});$(".btn-move").click(function(){var a=$.table.getAllSelectedCheckbox($("#table"));
if(!a.length){return
}$.app.confirm({title:"确认移动选中的文件",message:"<strong class='text-error'>注意：</strong><span class='text-error muted'>如果目标文件夹有同名的文件/目录，如果选择'先删除再移动'，可能造成目录丢失，请慎用</span><br/><br/><span class='text-error muted'>冲突时：<label class='radio inline'><input type='radio' name='conflict' value='override'>先删除再移动</label><label class='radio inline'><input type='radio' name='conflict' value='ignore' checked='checked'>跳过</label><br/>",ok:function(){var b=$("[name=conflict]:checked").val();
$.app.modalDialog("选择移动到的目录",ctx+"/maintain/editor/select?"+a.serialize(),{height:300,width:300,ok:function(d){var c=$.fn.zTree.getZTreeObj(d.find("#selectTree .ztree").attr("id"));
var e=c.getSelectedNodes()[0];
var f=e.path;
window.location.href=ctx+"/maintain/editor/move?descPath="+f+"&conflict="+b+"&"+a.serialize()
}})}})});$(".btn-copy").click(function(){var a=$.table.getAllSelectedCheckbox($("#table"));
if(!a.length){return
}$.app.confirm({title:"确认复制选中的文件",message:"<strong class='text-error'>注意：</strong><span class='text-error muted'>如果目标文件夹有同名的文件/目录，如果选择'先删除再移动'，可能造成目录丢失，请慎用</span><br/><br/><span class='text-error muted'>冲突时：<label class='radio inline'><input type='radio' name='conflict' value='override'>先删除再移动</label><label class='radio inline'><input type='radio' name='conflict' value='ignore' checked='checked'>跳过</label><br/>",ok:function(){var b=$("[name=conflict]:checked").val();
$.app.modalDialog("选择复制到的目录",ctx+"/maintain/editor/select?"+a.serialize(),{height:300,width:300,ok:function(d){var c=$.fn.zTree.getZTreeObj(d.find("#selectTree .ztree").attr("id"));
var e=c.getSelectedNodes()[0];
var f=e.path;
window.location.href=ctx+"/maintain/editor/copy?descPath="+f+"&conflict="+b+"&"+a.serialize()
}})}})})}}};